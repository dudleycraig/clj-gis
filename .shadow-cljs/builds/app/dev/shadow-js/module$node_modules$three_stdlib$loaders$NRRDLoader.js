["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/three-stdlib/loaders/NRRDLoader.js"],"~:js","shadow$provide.module$node_modules$three_stdlib$loaders$NRRDLoader=function(global,require,module,exports){function _typeof(obj$jscomp$0){_typeof=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&\"function\"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj};return _typeof(obj$jscomp$0)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=\ndescriptor.enumerable||!1;descriptor.configurable=!0;\"value\"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};\nreturn _getPrototypeOf(o$jscomp$0)}function _inherits(subClass,superClass){if(\"function\"!==typeof superClass&&null!==superClass)throw new TypeError(\"Super expression must either be null or a function\");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o$jscomp$0,p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};\nreturn _setPrototypeOf(o$jscomp$0,p$jscomp$0)}Object.defineProperty(exports,\"__esModule\",{value:!0});exports.NRRDLoader=void 0;var _three=require(\"module$node_modules$three$build$three_module\"),_fflate=require(\"module$node_modules$fflate$esm$browser\"),_Volume=require(\"module$node_modules$three_stdlib$misc$Volume\");global=function(_Loader){function NRRDLoader(manager){if(!(this instanceof NRRDLoader))throw new TypeError(\"Cannot call a class as a function\");manager=_getPrototypeOf(NRRDLoader).call(this,\nmanager);if(!manager||\"object\"!==_typeof(manager)&&\"function\"!==typeof manager){if(void 0===this)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");manager=this}return manager}_inherits(NRRDLoader,_Loader);_createClass(NRRDLoader,[{key:\"load\",value:function(url,onLoad,onProgress,onError){var scope=this,loader=new _three.FileLoader(scope.manager);loader.setPath(scope.path);loader.setResponseType(\"arraybuffer\");loader.setRequestHeader(scope.requestHeader);loader.setWithCredentials(scope.withCredentials);\nloader.load(url,function(data){try{onLoad(scope.parse(data))}catch(e){onError?onError(e):console.error(e),scope.manager.itemError(url)}},onProgress,onError)}},{key:\"parse\",value:function(data$jscomp$0){function parseDataAsText(data,start,end){var number=\"\";start=start||0;end=end||data.length;var lengthOfTheResult=headerObject.sizes.reduce(function(previous,current){return previous*current},1),base=10;\"hex\"===headerObject.encoding&&(base=16);lengthOfTheResult=new headerObject.__array(lengthOfTheResult);\nvar resultIndex=0,parsingFunction=parseInt;if(headerObject.__array===Float32Array||headerObject.__array===Float64Array)parsingFunction=parseFloat;for(var _i3=start;_i3<end;_i3++)start=data[_i3],(9>start||13<start)&&32!==start?number+=String.fromCharCode(start):(\"\"!==number&&(lengthOfTheResult[resultIndex]=parsingFunction(number,base),resultIndex++),number=\"\");\"\"!==number&&(lengthOfTheResult[resultIndex]=parsingFunction(number,base),resultIndex++);return lengthOfTheResult}var _data=data$jscomp$0,_dataPointer=\n0,_nativeLittleEndian=0<(new Int8Array((new Int16Array([1])).buffer))[0],headerObject={};data$jscomp$0=function(type,chunks){if(void 0===chunks||null===chunks)chunks=1;var _chunkSize=1,_array_type=Uint8Array;switch(type){case \"schar\":_array_type=Int8Array;break;case \"ushort\":_array_type=Uint16Array;_chunkSize=2;break;case \"sshort\":_array_type=Int16Array;_chunkSize=2;break;case \"uint\":_array_type=Uint32Array;_chunkSize=4;break;case \"sint\":_array_type=Int32Array;_chunkSize=4;break;case \"float\":_array_type=\nFloat32Array;_chunkSize=4;break;case \"complex\":_array_type=Float64Array;_chunkSize=8;break;case \"double\":_array_type=Float64Array,_chunkSize=8}type=new _array_type(_data.slice(_dataPointer,_dataPointer+=chunks*_chunkSize));if(1!=_nativeLittleEndian){_array_type=new Uint8Array(type.buffer,type.byteOffset,type.byteLength);for(var _i2=0;_i2<type.byteLength;_i2+=_chunkSize)for(var j=_i2+_chunkSize-1,k=_i2;j>k;j--,k++){var tmp=_array_type[k];_array_type[k]=_array_type[j];_array_type[j]=tmp}}return 1==\nchunks?type[0]:type}(\"uchar\",data$jscomp$0.byteLength);var _length=data$jscomp$0.length,_header=null,_data_start=0,i$jscomp$0;for(i$jscomp$0=1;i$jscomp$0<_length;i$jscomp$0++)if(10==data$jscomp$0[i$jscomp$0-1]&&10==data$jscomp$0[i$jscomp$0]){_header=this.parseChars(data$jscomp$0,0,i$jscomp$0-2);_data_start=i$jscomp$0+1;break}(function(header){var fn,i,_len,lines=header.split(/\\r?\\n/);header=0;for(_len=lines.length;header<_len;header++){var data=lines[header];if(data.match(/NRRD\\d+/))headerObject.isNrrd=\n!0;else if(!data.match(/^#/)&&(i=data.match(/(.*):(.*)/))){var field=i[1].trim();data=i[2].trim();(fn=_fieldFunctions[field])?fn.call(headerObject,data):headerObject[field]=data}}if(!headerObject.isNrrd)throw Error(\"Not an NRRD file\");if(\"bz2\"===headerObject.encoding||\"bzip2\"===headerObject.encoding)throw Error(\"Bzip is not supported\");if(!headerObject.vectors&&(headerObject.vectors=[new _three.Vector3(1,0,0),new _three.Vector3(0,1,0),new _three.Vector3(0,0,1)],headerObject.spacings))for(i=0;2>=i;i++)isNaN(headerObject.spacings[i])||\nheaderObject.vectors[i].multiplyScalar(headerObject.spacings[i])})(_header);_data=data$jscomp$0.subarray(_data_start);if(\"gz\"===headerObject.encoding.substring(0,2))_data=(0,_fflate.gunzipSync)(new Uint8Array(_data));else if(\"ascii\"===headerObject.encoding||\"text\"===headerObject.encoding||\"txt\"===headerObject.encoding||\"hex\"===headerObject.encoding)_data=parseDataAsText(_data);else if(\"raw\"===headerObject.encoding){data$jscomp$0=new Uint8Array(_data.length);for(_length=0;_length<_data.length;_length++)data$jscomp$0[_length]=\n_data[_length];_data=data$jscomp$0}_data=_data.buffer;data$jscomp$0=new _Volume.Volume;data$jscomp$0.header=headerObject;data$jscomp$0.data=new headerObject.__array(_data);_header=data$jscomp$0.computeMinMax();_length=_header[0];_header=_header[1];data$jscomp$0.windowLow=_length;data$jscomp$0.windowHigh=_header;data$jscomp$0.dimensions=[headerObject.sizes[0],headerObject.sizes[1],headerObject.sizes[2]];data$jscomp$0.xLength=data$jscomp$0.dimensions[0];data$jscomp$0.yLength=data$jscomp$0.dimensions[1];\ndata$jscomp$0.zLength=data$jscomp$0.dimensions[2];_data_start=(new _three.Vector3(headerObject.vectors[0][0],headerObject.vectors[0][1],headerObject.vectors[0][2])).length();i$jscomp$0=(new _three.Vector3(headerObject.vectors[1][0],headerObject.vectors[1][1],headerObject.vectors[1][2])).length();var spacingZ=(new _three.Vector3(headerObject.vectors[2][0],headerObject.vectors[2][1],headerObject.vectors[2][2])).length();data$jscomp$0.spacing=[_data_start,i$jscomp$0,spacingZ];data$jscomp$0.matrix=new _three.Matrix4;\ni$jscomp$0=_data_start=1;\"left-posterior-superior\"==headerObject.space?i$jscomp$0=_data_start=-1:\"left-anterior-superior\"===headerObject.space&&(_data_start=-1);headerObject.vectors?(spacingZ=headerObject.vectors,data$jscomp$0.matrix.set(_data_start*spacingZ[0][0],_data_start*spacingZ[1][0],_data_start*spacingZ[2][0],0,i$jscomp$0*spacingZ[0][1],i$jscomp$0*spacingZ[1][1],i$jscomp$0*spacingZ[2][1],0,1*spacingZ[0][2],1*spacingZ[1][2],1*spacingZ[2][2],0,0,0,0,1)):data$jscomp$0.matrix.set(_data_start,\n0,0,0,0,i$jscomp$0,0,0,0,0,1,0,0,0,0,1);data$jscomp$0.inverseMatrix=new _three.Matrix4;data$jscomp$0.inverseMatrix.copy(data$jscomp$0.matrix).invert();data$jscomp$0.RASDimensions=(new _three.Vector3(data$jscomp$0.xLength,data$jscomp$0.yLength,data$jscomp$0.zLength)).applyMatrix4(data$jscomp$0.matrix).round().toArray().map(Math.abs);-Infinity===data$jscomp$0.lowerThreshold&&(data$jscomp$0.lowerThreshold=_length);Infinity===data$jscomp$0.upperThreshold&&(data$jscomp$0.upperThreshold=_header);return data$jscomp$0}},\n{key:\"parseChars\",value:function(array,start,end){void 0===start&&(start=0);void 0===end&&(end=array.length);for(var output=\"\";start<end;++start)output+=String.fromCharCode(array[start]);return output}}]);return NRRDLoader}(_three.Loader);exports.NRRDLoader=global;var _fieldFunctions={type:function(data){switch(data){case \"uchar\":case \"unsigned char\":case \"uint8\":case \"uint8_t\":this.__array=Uint8Array;break;case \"signed char\":case \"int8\":case \"int8_t\":this.__array=Int8Array;break;case \"short\":case \"short int\":case \"signed short\":case \"signed short int\":case \"int16\":case \"int16_t\":this.__array=\nInt16Array;break;case \"ushort\":case \"unsigned short\":case \"unsigned short int\":case \"uint16\":case \"uint16_t\":this.__array=Uint16Array;break;case \"int\":case \"signed int\":case \"int32\":case \"int32_t\":this.__array=Int32Array;break;case \"uint\":case \"unsigned int\":case \"uint32\":case \"uint32_t\":this.__array=Uint32Array;break;case \"float\":this.__array=Float32Array;break;case \"double\":this.__array=Float64Array;break;default:throw Error(\"Unsupported NRRD data type: \"+data);}return this.type=data},endian:function(data){return this.endian=\ndata},encoding:function(data){return this.encoding=data},dimension:function(data){return this.dim=parseInt(data,10)},sizes:function(data){for(var _ref=data.split(/\\s+/),_results=[],_i=0,_len=_ref.length;_i<_len;_i++)data=_ref[_i],_results.push(parseInt(data,10));return this.sizes=_results},space:function(data){return this.space=data},\"space origin\":function(data){return this.space_origin=data.split(\"(\")[1].split(\")\")[0].split(\",\")},\"space directions\":function(data){data=data.match(/\\(.*?\\)/g);for(var _results=\n[],_i=0,_len=data.length;_i<_len;_i++){var f=data[_i];for(var JSCompiler_temp_const=_results,JSCompiler_temp_const$jscomp$0=JSCompiler_temp_const.push,_ref=f.slice(1,-1).split(/,/),_results2=[],_j=0,_len2=_ref.length;_j<_len2;_j++)f=_ref[_j],_results2.push(parseFloat(f));JSCompiler_temp_const$jscomp$0.call(JSCompiler_temp_const,_results2)}return this.vectors=_results},spacings:function(data){for(var parts=data.split(/\\s+/),_results=[],_i=0,_len=parts.length;_i<_len;_i++)data=parts[_i],_results.push(parseFloat(data));\nreturn this.spacings=_results}}}","~:source","shadow$provide[\"module$node_modules$three_stdlib$loaders$NRRDLoader\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NRRDLoader = void 0;\n\nvar _three = require(\"three\");\n\nvar _fflate = require(\"fflate\");\n\nvar _Volume = require(\"../misc/Volume.js\");\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar NRRDLoader =\n/*#__PURE__*/\nfunction (_Loader) {\n  _inherits(NRRDLoader, _Loader);\n\n  function NRRDLoader(manager) {\n    _classCallCheck(this, NRRDLoader);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(NRRDLoader).call(this, manager));\n  }\n\n  _createClass(NRRDLoader, [{\n    key: \"load\",\n    value: function load(url, onLoad, onProgress, onError) {\n      var scope = this;\n      var loader = new _three.FileLoader(scope.manager);\n      loader.setPath(scope.path);\n      loader.setResponseType('arraybuffer');\n      loader.setRequestHeader(scope.requestHeader);\n      loader.setWithCredentials(scope.withCredentials);\n      loader.load(url, function (data) {\n        try {\n          onLoad(scope.parse(data));\n        } catch (e) {\n          if (onError) {\n            onError(e);\n          } else {\n            console.error(e);\n          }\n\n          scope.manager.itemError(url);\n        }\n      }, onProgress, onError);\n    }\n  }, {\n    key: \"parse\",\n    value: function parse(data) {\n      // this parser is largely inspired from the XTK NRRD parser : https://github.com/xtk/X\n      var _data = data;\n      var _dataPointer = 0;\n\n      var _nativeLittleEndian = new Int8Array(new Int16Array([1]).buffer)[0] > 0;\n\n      var _littleEndian = true;\n      var headerObject = {};\n\n      function scan(type, chunks) {\n        if (chunks === undefined || chunks === null) {\n          chunks = 1;\n        }\n\n        var _chunkSize = 1;\n        var _array_type = Uint8Array;\n\n        switch (type) {\n          // 1 byte data types\n          case 'uchar':\n            break;\n\n          case 'schar':\n            _array_type = Int8Array;\n            break;\n          // 2 byte data types\n\n          case 'ushort':\n            _array_type = Uint16Array;\n            _chunkSize = 2;\n            break;\n\n          case 'sshort':\n            _array_type = Int16Array;\n            _chunkSize = 2;\n            break;\n          // 4 byte data types\n\n          case 'uint':\n            _array_type = Uint32Array;\n            _chunkSize = 4;\n            break;\n\n          case 'sint':\n            _array_type = Int32Array;\n            _chunkSize = 4;\n            break;\n\n          case 'float':\n            _array_type = Float32Array;\n            _chunkSize = 4;\n            break;\n\n          case 'complex':\n            _array_type = Float64Array;\n            _chunkSize = 8;\n            break;\n\n          case 'double':\n            _array_type = Float64Array;\n            _chunkSize = 8;\n            break;\n        } // increase the data pointer in-place\n\n\n        var _bytes = new _array_type(_data.slice(_dataPointer, _dataPointer += chunks * _chunkSize)); // if required, flip the endianness of the bytes\n\n\n        if (_nativeLittleEndian != _littleEndian) {\n          // we need to flip here since the format doesn't match the native endianness\n          _bytes = flipEndianness(_bytes, _chunkSize);\n        }\n\n        if (chunks == 1) {\n          // if only one chunk was requested, just return one value\n          return _bytes[0];\n        } // return the byte array\n\n\n        return _bytes;\n      } //Flips typed array endianness in-place. Based on https://github.com/kig/DataStream.js/blob/master/DataStream.js.\n\n\n      function flipEndianness(array, chunkSize) {\n        var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n\n        for (var _i2 = 0; _i2 < array.byteLength; _i2 += chunkSize) {\n          for (var j = _i2 + chunkSize - 1, k = _i2; j > k; j--, k++) {\n            var tmp = u8[k];\n            u8[k] = u8[j];\n            u8[j] = tmp;\n          }\n        }\n\n        return array;\n      } //parse the header\n\n\n      function parseHeader(header) {\n        var data, field, fn, i, l, m, _i, _len;\n\n        var lines = header.split(/\\r?\\n/);\n\n        for (_i = 0, _len = lines.length; _i < _len; _i++) {\n          l = lines[_i];\n\n          if (l.match(/NRRD\\d+/)) {\n            headerObject.isNrrd = true;\n          } else if (l.match(/^#/)) ;else if (m = l.match(/(.*):(.*)/)) {\n            field = m[1].trim();\n            data = m[2].trim();\n            fn = _fieldFunctions[field];\n\n            if (fn) {\n              fn.call(headerObject, data);\n            } else {\n              headerObject[field] = data;\n            }\n          }\n        }\n\n        if (!headerObject.isNrrd) {\n          throw new Error('Not an NRRD file');\n        }\n\n        if (headerObject.encoding === 'bz2' || headerObject.encoding === 'bzip2') {\n          throw new Error('Bzip is not supported');\n        }\n\n        if (!headerObject.vectors) {\n          //if no space direction is set, let's use the identity\n          headerObject.vectors = [new _three.Vector3(1, 0, 0), new _three.Vector3(0, 1, 0), new _three.Vector3(0, 0, 1)]; //apply spacing if defined\n\n          if (headerObject.spacings) {\n            for (i = 0; i <= 2; i++) {\n              if (!isNaN(headerObject.spacings[i])) {\n                headerObject.vectors[i].multiplyScalar(headerObject.spacings[i]);\n              }\n            }\n          }\n        }\n      } //parse the data when registred as one of this type : 'text', 'ascii', 'txt'\n\n\n      function parseDataAsText(data, start, end) {\n        var number = '';\n        start = start || 0;\n        end = end || data.length;\n        var value; //length of the result is the product of the sizes\n\n        var lengthOfTheResult = headerObject.sizes.reduce(function (previous, current) {\n          return previous * current;\n        }, 1);\n        var base = 10;\n\n        if (headerObject.encoding === 'hex') {\n          base = 16;\n        }\n\n        var result = new headerObject.__array(lengthOfTheResult);\n        var resultIndex = 0;\n        var parsingFunction = parseInt;\n\n        if (headerObject.__array === Float32Array || headerObject.__array === Float64Array) {\n          parsingFunction = parseFloat;\n        }\n\n        for (var _i3 = start; _i3 < end; _i3++) {\n          value = data[_i3]; //if value is not a space\n\n          if ((value < 9 || value > 13) && value !== 32) {\n            number += String.fromCharCode(value);\n          } else {\n            if (number !== '') {\n              result[resultIndex] = parsingFunction(number, base);\n              resultIndex++;\n            }\n\n            number = '';\n          }\n        }\n\n        if (number !== '') {\n          result[resultIndex] = parsingFunction(number, base);\n          resultIndex++;\n        }\n\n        return result;\n      }\n\n      var _bytes = scan('uchar', data.byteLength);\n\n      var _length = _bytes.length;\n      var _header = null;\n      var _data_start = 0;\n      var i;\n\n      for (i = 1; i < _length; i++) {\n        if (_bytes[i - 1] == 10 && _bytes[i] == 10) {\n          // we found two line breaks in a row\n          // now we know what the header is\n          _header = this.parseChars(_bytes, 0, i - 2); // this is were the data starts\n\n          _data_start = i + 1;\n          break;\n        }\n      } // parse the header\n\n\n      parseHeader(_header);\n      _data = _bytes.subarray(_data_start); // the data without header\n\n      if (headerObject.encoding.substring(0, 2) === 'gz') {\n        // we need to decompress the datastream\n        // here we start the unzipping and get a typed Uint8Array back\n        _data = (0, _fflate.gunzipSync)(new Uint8Array(_data)); // eslint-disable-line no-undef\n      } else if (headerObject.encoding === 'ascii' || headerObject.encoding === 'text' || headerObject.encoding === 'txt' || headerObject.encoding === 'hex') {\n        _data = parseDataAsText(_data);\n      } else if (headerObject.encoding === 'raw') {\n        //we need to copy the array to create a new array buffer, else we retrieve the original arraybuffer with the header\n        var _copy = new Uint8Array(_data.length);\n\n        for (var _i4 = 0; _i4 < _data.length; _i4++) {\n          _copy[_i4] = _data[_i4];\n        }\n\n        _data = _copy;\n      } // .. let's use the underlying array buffer\n\n\n      _data = _data.buffer;\n      var volume = new _Volume.Volume();\n      volume.header = headerObject; //\n      // parse the (unzipped) data to a datastream of the correct type\n      //\n\n      volume.data = new headerObject.__array(_data); // get the min and max intensities\n\n      var min_max = volume.computeMinMax();\n      var min = min_max[0];\n      var max = min_max[1]; // attach the scalar range to the volume\n\n      volume.windowLow = min;\n      volume.windowHigh = max; // get the image dimensions\n\n      volume.dimensions = [headerObject.sizes[0], headerObject.sizes[1], headerObject.sizes[2]];\n      volume.xLength = volume.dimensions[0];\n      volume.yLength = volume.dimensions[1];\n      volume.zLength = volume.dimensions[2]; // spacing\n\n      var spacingX = new _three.Vector3(headerObject.vectors[0][0], headerObject.vectors[0][1], headerObject.vectors[0][2]).length();\n      var spacingY = new _three.Vector3(headerObject.vectors[1][0], headerObject.vectors[1][1], headerObject.vectors[1][2]).length();\n      var spacingZ = new _three.Vector3(headerObject.vectors[2][0], headerObject.vectors[2][1], headerObject.vectors[2][2]).length();\n      volume.spacing = [spacingX, spacingY, spacingZ]; // Create IJKtoRAS matrix\n\n      volume.matrix = new _three.Matrix4();\n      var _spaceX = 1;\n      var _spaceY = 1;\n      var _spaceZ = 1;\n\n      if (headerObject.space == 'left-posterior-superior') {\n        _spaceX = -1;\n        _spaceY = -1;\n      } else if (headerObject.space === 'left-anterior-superior') {\n        _spaceX = -1;\n      }\n\n      if (!headerObject.vectors) {\n        volume.matrix.set(_spaceX, 0, 0, 0, 0, _spaceY, 0, 0, 0, 0, _spaceZ, 0, 0, 0, 0, 1);\n      } else {\n        var v = headerObject.vectors;\n        volume.matrix.set(_spaceX * v[0][0], _spaceX * v[1][0], _spaceX * v[2][0], 0, _spaceY * v[0][1], _spaceY * v[1][1], _spaceY * v[2][1], 0, _spaceZ * v[0][2], _spaceZ * v[1][2], _spaceZ * v[2][2], 0, 0, 0, 0, 1);\n      }\n\n      volume.inverseMatrix = new _three.Matrix4();\n      volume.inverseMatrix.copy(volume.matrix).invert();\n      volume.RASDimensions = new _three.Vector3(volume.xLength, volume.yLength, volume.zLength).applyMatrix4(volume.matrix).round().toArray().map(Math.abs); // .. and set the default threshold\n      // only if the threshold was not already set\n\n      if (volume.lowerThreshold === -Infinity) {\n        volume.lowerThreshold = min;\n      }\n\n      if (volume.upperThreshold === Infinity) {\n        volume.upperThreshold = max;\n      }\n\n      return volume;\n    }\n  }, {\n    key: \"parseChars\",\n    value: function parseChars(array, start, end) {\n      // without borders, use the whole array\n      if (start === undefined) {\n        start = 0;\n      }\n\n      if (end === undefined) {\n        end = array.length;\n      }\n\n      var output = ''; // create and append the chars\n\n      var i = 0;\n\n      for (i = start; i < end; ++i) {\n        output += String.fromCharCode(array[i]);\n      }\n\n      return output;\n    }\n  }]);\n\n  return NRRDLoader;\n}(_three.Loader);\n\nexports.NRRDLoader = NRRDLoader;\nvar _fieldFunctions = {\n  type: function type(data) {\n    switch (data) {\n      case 'uchar':\n      case 'unsigned char':\n      case 'uint8':\n      case 'uint8_t':\n        this.__array = Uint8Array;\n        break;\n\n      case 'signed char':\n      case 'int8':\n      case 'int8_t':\n        this.__array = Int8Array;\n        break;\n\n      case 'short':\n      case 'short int':\n      case 'signed short':\n      case 'signed short int':\n      case 'int16':\n      case 'int16_t':\n        this.__array = Int16Array;\n        break;\n\n      case 'ushort':\n      case 'unsigned short':\n      case 'unsigned short int':\n      case 'uint16':\n      case 'uint16_t':\n        this.__array = Uint16Array;\n        break;\n\n      case 'int':\n      case 'signed int':\n      case 'int32':\n      case 'int32_t':\n        this.__array = Int32Array;\n        break;\n\n      case 'uint':\n      case 'unsigned int':\n      case 'uint32':\n      case 'uint32_t':\n        this.__array = Uint32Array;\n        break;\n\n      case 'float':\n        this.__array = Float32Array;\n        break;\n\n      case 'double':\n        this.__array = Float64Array;\n        break;\n\n      default:\n        throw new Error('Unsupported NRRD data type: ' + data);\n    }\n\n    return this.type = data;\n  },\n  endian: function endian(data) {\n    return this.endian = data;\n  },\n  encoding: function encoding(data) {\n    return this.encoding = data;\n  },\n  dimension: function dimension(data) {\n    return this.dim = parseInt(data, 10);\n  },\n  sizes: function sizes(data) {\n    var i;\n    return this.sizes = function () {\n      var _ref = data.split(/\\s+/);\n\n      var _results = [];\n\n      for (var _i = 0, _len = _ref.length; _i < _len; _i++) {\n        i = _ref[_i];\n\n        _results.push(parseInt(i, 10));\n      }\n\n      return _results;\n    }();\n  },\n  space: function space(data) {\n    return this.space = data;\n  },\n  'space origin': function spaceOrigin(data) {\n    return this.space_origin = data.split('(')[1].split(')')[0].split(',');\n  },\n  'space directions': function spaceDirections(data) {\n    var f, v;\n    var parts = data.match(/\\(.*?\\)/g);\n    return this.vectors = function () {\n      var _results = [];\n\n      for (var _i = 0, _len = parts.length; _i < _len; _i++) {\n        v = parts[_i];\n\n        _results.push(function () {\n          var _ref = v.slice(1, -1).split(/,/);\n\n          var _results2 = [];\n\n          for (var _j = 0, _len2 = _ref.length; _j < _len2; _j++) {\n            f = _ref[_j];\n\n            _results2.push(parseFloat(f));\n          }\n\n          return _results2;\n        }());\n      }\n\n      return _results;\n    }();\n  },\n  spacings: function spacings(data) {\n    var f;\n    var parts = data.split(/\\s+/);\n    return this.spacings = function () {\n      var _results = [];\n\n      for (var _i = 0, _len = parts.length; _i < _len; _i++) {\n        f = parts[_i];\n\n        _results.push(parseFloat(f));\n      }\n\n      return _results;\n    }();\n  }\n};\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$three$build$three_module","~$shadow.js","~$module$node_modules$three_stdlib$misc$Volume","~$module$node_modules$fflate$esm$browser"]],"~:properties",["^5",["NRRDLoader","inverseMatrix","vectors","lowerThreshold","space","spacing","space_origin","yLength","upperThreshold","prototype","key","matrix","isNrrd","__esModule","encoding","spacings","configurable","value","dimensions","enumerable","writable","windowLow","type","__proto__","endian","sizes","windowHigh","RASDimensions","dimension","data","xLength","zLength","header","__array","constructor","dim"]],"~:compiled-at",1630917515609,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$three_stdlib$loaders$NRRDLoader.js\",\n\"lineCount\":21,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/three-stdlib/loaders/NRRDLoader.js\"],\n\"sourcesContent\":[\"shadow$provide[\\\"module$node_modules$three_stdlib$loaders$NRRDLoader\\\"] = function(global,require,module,exports) {\\n\\\"use strict\\\";\\n\\nObject.defineProperty(exports, \\\"__esModule\\\", {\\n  value: true\\n});\\nexports.NRRDLoader = void 0;\\n\\nvar _three = require(\\\"three\\\");\\n\\nvar _fflate = require(\\\"fflate\\\");\\n\\nvar _Volume = require(\\\"../misc/Volume.js\\\");\\n\\nfunction _typeof(obj) { if (typeof Symbol === \\\"function\\\" && typeof Symbol.iterator === \\\"symbol\\\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \\\"function\\\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \\\"symbol\\\" : typeof obj; }; } return _typeof(obj); }\\n\\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\\\"Cannot call a class as a function\\\"); } }\\n\\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\\\"value\\\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\\n\\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\\n\\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \\\"object\\\" || typeof call === \\\"function\\\")) { return call; } return _assertThisInitialized(self); }\\n\\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\\\"this hasn't been initialised - super() hasn't been called\\\"); } return self; }\\n\\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\\n\\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \\\"function\\\" && superClass !== null) { throw new TypeError(\\\"Super expression must either be null or a function\\\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\\n\\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\\n\\nvar NRRDLoader =\\n/*#__PURE__*/\\nfunction (_Loader) {\\n  _inherits(NRRDLoader, _Loader);\\n\\n  function NRRDLoader(manager) {\\n    _classCallCheck(this, NRRDLoader);\\n\\n    return _possibleConstructorReturn(this, _getPrototypeOf(NRRDLoader).call(this, manager));\\n  }\\n\\n  _createClass(NRRDLoader, [{\\n    key: \\\"load\\\",\\n    value: function load(url, onLoad, onProgress, onError) {\\n      var scope = this;\\n      var loader = new _three.FileLoader(scope.manager);\\n      loader.setPath(scope.path);\\n      loader.setResponseType('arraybuffer');\\n      loader.setRequestHeader(scope.requestHeader);\\n      loader.setWithCredentials(scope.withCredentials);\\n      loader.load(url, function (data) {\\n        try {\\n          onLoad(scope.parse(data));\\n        } catch (e) {\\n          if (onError) {\\n            onError(e);\\n          } else {\\n            console.error(e);\\n          }\\n\\n          scope.manager.itemError(url);\\n        }\\n      }, onProgress, onError);\\n    }\\n  }, {\\n    key: \\\"parse\\\",\\n    value: function parse(data) {\\n      // this parser is largely inspired from the XTK NRRD parser : https://github.com/xtk/X\\n      var _data = data;\\n      var _dataPointer = 0;\\n\\n      var _nativeLittleEndian = new Int8Array(new Int16Array([1]).buffer)[0] > 0;\\n\\n      var _littleEndian = true;\\n      var headerObject = {};\\n\\n      function scan(type, chunks) {\\n        if (chunks === undefined || chunks === null) {\\n          chunks = 1;\\n        }\\n\\n        var _chunkSize = 1;\\n        var _array_type = Uint8Array;\\n\\n        switch (type) {\\n          // 1 byte data types\\n          case 'uchar':\\n            break;\\n\\n          case 'schar':\\n            _array_type = Int8Array;\\n            break;\\n          // 2 byte data types\\n\\n          case 'ushort':\\n            _array_type = Uint16Array;\\n            _chunkSize = 2;\\n            break;\\n\\n          case 'sshort':\\n            _array_type = Int16Array;\\n            _chunkSize = 2;\\n            break;\\n          // 4 byte data types\\n\\n          case 'uint':\\n            _array_type = Uint32Array;\\n            _chunkSize = 4;\\n            break;\\n\\n          case 'sint':\\n            _array_type = Int32Array;\\n            _chunkSize = 4;\\n            break;\\n\\n          case 'float':\\n            _array_type = Float32Array;\\n            _chunkSize = 4;\\n            break;\\n\\n          case 'complex':\\n            _array_type = Float64Array;\\n            _chunkSize = 8;\\n            break;\\n\\n          case 'double':\\n            _array_type = Float64Array;\\n            _chunkSize = 8;\\n            break;\\n        } // increase the data pointer in-place\\n\\n\\n        var _bytes = new _array_type(_data.slice(_dataPointer, _dataPointer += chunks * _chunkSize)); // if required, flip the endianness of the bytes\\n\\n\\n        if (_nativeLittleEndian != _littleEndian) {\\n          // we need to flip here since the format doesn't match the native endianness\\n          _bytes = flipEndianness(_bytes, _chunkSize);\\n        }\\n\\n        if (chunks == 1) {\\n          // if only one chunk was requested, just return one value\\n          return _bytes[0];\\n        } // return the byte array\\n\\n\\n        return _bytes;\\n      } //Flips typed array endianness in-place. Based on https://github.com/kig/DataStream.js/blob/master/DataStream.js.\\n\\n\\n      function flipEndianness(array, chunkSize) {\\n        var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\\n\\n        for (var _i2 = 0; _i2 < array.byteLength; _i2 += chunkSize) {\\n          for (var j = _i2 + chunkSize - 1, k = _i2; j > k; j--, k++) {\\n            var tmp = u8[k];\\n            u8[k] = u8[j];\\n            u8[j] = tmp;\\n          }\\n        }\\n\\n        return array;\\n      } //parse the header\\n\\n\\n      function parseHeader(header) {\\n        var data, field, fn, i, l, m, _i, _len;\\n\\n        var lines = header.split(/\\\\r?\\\\n/);\\n\\n        for (_i = 0, _len = lines.length; _i < _len; _i++) {\\n          l = lines[_i];\\n\\n          if (l.match(/NRRD\\\\d+/)) {\\n            headerObject.isNrrd = true;\\n          } else if (l.match(/^#/)) ;else if (m = l.match(/(.*):(.*)/)) {\\n            field = m[1].trim();\\n            data = m[2].trim();\\n            fn = _fieldFunctions[field];\\n\\n            if (fn) {\\n              fn.call(headerObject, data);\\n            } else {\\n              headerObject[field] = data;\\n            }\\n          }\\n        }\\n\\n        if (!headerObject.isNrrd) {\\n          throw new Error('Not an NRRD file');\\n        }\\n\\n        if (headerObject.encoding === 'bz2' || headerObject.encoding === 'bzip2') {\\n          throw new Error('Bzip is not supported');\\n        }\\n\\n        if (!headerObject.vectors) {\\n          //if no space direction is set, let's use the identity\\n          headerObject.vectors = [new _three.Vector3(1, 0, 0), new _three.Vector3(0, 1, 0), new _three.Vector3(0, 0, 1)]; //apply spacing if defined\\n\\n          if (headerObject.spacings) {\\n            for (i = 0; i <= 2; i++) {\\n              if (!isNaN(headerObject.spacings[i])) {\\n                headerObject.vectors[i].multiplyScalar(headerObject.spacings[i]);\\n              }\\n            }\\n          }\\n        }\\n      } //parse the data when registred as one of this type : 'text', 'ascii', 'txt'\\n\\n\\n      function parseDataAsText(data, start, end) {\\n        var number = '';\\n        start = start || 0;\\n        end = end || data.length;\\n        var value; //length of the result is the product of the sizes\\n\\n        var lengthOfTheResult = headerObject.sizes.reduce(function (previous, current) {\\n          return previous * current;\\n        }, 1);\\n        var base = 10;\\n\\n        if (headerObject.encoding === 'hex') {\\n          base = 16;\\n        }\\n\\n        var result = new headerObject.__array(lengthOfTheResult);\\n        var resultIndex = 0;\\n        var parsingFunction = parseInt;\\n\\n        if (headerObject.__array === Float32Array || headerObject.__array === Float64Array) {\\n          parsingFunction = parseFloat;\\n        }\\n\\n        for (var _i3 = start; _i3 < end; _i3++) {\\n          value = data[_i3]; //if value is not a space\\n\\n          if ((value < 9 || value > 13) && value !== 32) {\\n            number += String.fromCharCode(value);\\n          } else {\\n            if (number !== '') {\\n              result[resultIndex] = parsingFunction(number, base);\\n              resultIndex++;\\n            }\\n\\n            number = '';\\n          }\\n        }\\n\\n        if (number !== '') {\\n          result[resultIndex] = parsingFunction(number, base);\\n          resultIndex++;\\n        }\\n\\n        return result;\\n      }\\n\\n      var _bytes = scan('uchar', data.byteLength);\\n\\n      var _length = _bytes.length;\\n      var _header = null;\\n      var _data_start = 0;\\n      var i;\\n\\n      for (i = 1; i < _length; i++) {\\n        if (_bytes[i - 1] == 10 && _bytes[i] == 10) {\\n          // we found two line breaks in a row\\n          // now we know what the header is\\n          _header = this.parseChars(_bytes, 0, i - 2); // this is were the data starts\\n\\n          _data_start = i + 1;\\n          break;\\n        }\\n      } // parse the header\\n\\n\\n      parseHeader(_header);\\n      _data = _bytes.subarray(_data_start); // the data without header\\n\\n      if (headerObject.encoding.substring(0, 2) === 'gz') {\\n        // we need to decompress the datastream\\n        // here we start the unzipping and get a typed Uint8Array back\\n        _data = (0, _fflate.gunzipSync)(new Uint8Array(_data)); // eslint-disable-line no-undef\\n      } else if (headerObject.encoding === 'ascii' || headerObject.encoding === 'text' || headerObject.encoding === 'txt' || headerObject.encoding === 'hex') {\\n        _data = parseDataAsText(_data);\\n      } else if (headerObject.encoding === 'raw') {\\n        //we need to copy the array to create a new array buffer, else we retrieve the original arraybuffer with the header\\n        var _copy = new Uint8Array(_data.length);\\n\\n        for (var _i4 = 0; _i4 < _data.length; _i4++) {\\n          _copy[_i4] = _data[_i4];\\n        }\\n\\n        _data = _copy;\\n      } // .. let's use the underlying array buffer\\n\\n\\n      _data = _data.buffer;\\n      var volume = new _Volume.Volume();\\n      volume.header = headerObject; //\\n      // parse the (unzipped) data to a datastream of the correct type\\n      //\\n\\n      volume.data = new headerObject.__array(_data); // get the min and max intensities\\n\\n      var min_max = volume.computeMinMax();\\n      var min = min_max[0];\\n      var max = min_max[1]; // attach the scalar range to the volume\\n\\n      volume.windowLow = min;\\n      volume.windowHigh = max; // get the image dimensions\\n\\n      volume.dimensions = [headerObject.sizes[0], headerObject.sizes[1], headerObject.sizes[2]];\\n      volume.xLength = volume.dimensions[0];\\n      volume.yLength = volume.dimensions[1];\\n      volume.zLength = volume.dimensions[2]; // spacing\\n\\n      var spacingX = new _three.Vector3(headerObject.vectors[0][0], headerObject.vectors[0][1], headerObject.vectors[0][2]).length();\\n      var spacingY = new _three.Vector3(headerObject.vectors[1][0], headerObject.vectors[1][1], headerObject.vectors[1][2]).length();\\n      var spacingZ = new _three.Vector3(headerObject.vectors[2][0], headerObject.vectors[2][1], headerObject.vectors[2][2]).length();\\n      volume.spacing = [spacingX, spacingY, spacingZ]; // Create IJKtoRAS matrix\\n\\n      volume.matrix = new _three.Matrix4();\\n      var _spaceX = 1;\\n      var _spaceY = 1;\\n      var _spaceZ = 1;\\n\\n      if (headerObject.space == 'left-posterior-superior') {\\n        _spaceX = -1;\\n        _spaceY = -1;\\n      } else if (headerObject.space === 'left-anterior-superior') {\\n        _spaceX = -1;\\n      }\\n\\n      if (!headerObject.vectors) {\\n        volume.matrix.set(_spaceX, 0, 0, 0, 0, _spaceY, 0, 0, 0, 0, _spaceZ, 0, 0, 0, 0, 1);\\n      } else {\\n        var v = headerObject.vectors;\\n        volume.matrix.set(_spaceX * v[0][0], _spaceX * v[1][0], _spaceX * v[2][0], 0, _spaceY * v[0][1], _spaceY * v[1][1], _spaceY * v[2][1], 0, _spaceZ * v[0][2], _spaceZ * v[1][2], _spaceZ * v[2][2], 0, 0, 0, 0, 1);\\n      }\\n\\n      volume.inverseMatrix = new _three.Matrix4();\\n      volume.inverseMatrix.copy(volume.matrix).invert();\\n      volume.RASDimensions = new _three.Vector3(volume.xLength, volume.yLength, volume.zLength).applyMatrix4(volume.matrix).round().toArray().map(Math.abs); // .. and set the default threshold\\n      // only if the threshold was not already set\\n\\n      if (volume.lowerThreshold === -Infinity) {\\n        volume.lowerThreshold = min;\\n      }\\n\\n      if (volume.upperThreshold === Infinity) {\\n        volume.upperThreshold = max;\\n      }\\n\\n      return volume;\\n    }\\n  }, {\\n    key: \\\"parseChars\\\",\\n    value: function parseChars(array, start, end) {\\n      // without borders, use the whole array\\n      if (start === undefined) {\\n        start = 0;\\n      }\\n\\n      if (end === undefined) {\\n        end = array.length;\\n      }\\n\\n      var output = ''; // create and append the chars\\n\\n      var i = 0;\\n\\n      for (i = start; i < end; ++i) {\\n        output += String.fromCharCode(array[i]);\\n      }\\n\\n      return output;\\n    }\\n  }]);\\n\\n  return NRRDLoader;\\n}(_three.Loader);\\n\\nexports.NRRDLoader = NRRDLoader;\\nvar _fieldFunctions = {\\n  type: function type(data) {\\n    switch (data) {\\n      case 'uchar':\\n      case 'unsigned char':\\n      case 'uint8':\\n      case 'uint8_t':\\n        this.__array = Uint8Array;\\n        break;\\n\\n      case 'signed char':\\n      case 'int8':\\n      case 'int8_t':\\n        this.__array = Int8Array;\\n        break;\\n\\n      case 'short':\\n      case 'short int':\\n      case 'signed short':\\n      case 'signed short int':\\n      case 'int16':\\n      case 'int16_t':\\n        this.__array = Int16Array;\\n        break;\\n\\n      case 'ushort':\\n      case 'unsigned short':\\n      case 'unsigned short int':\\n      case 'uint16':\\n      case 'uint16_t':\\n        this.__array = Uint16Array;\\n        break;\\n\\n      case 'int':\\n      case 'signed int':\\n      case 'int32':\\n      case 'int32_t':\\n        this.__array = Int32Array;\\n        break;\\n\\n      case 'uint':\\n      case 'unsigned int':\\n      case 'uint32':\\n      case 'uint32_t':\\n        this.__array = Uint32Array;\\n        break;\\n\\n      case 'float':\\n        this.__array = Float32Array;\\n        break;\\n\\n      case 'double':\\n        this.__array = Float64Array;\\n        break;\\n\\n      default:\\n        throw new Error('Unsupported NRRD data type: ' + data);\\n    }\\n\\n    return this.type = data;\\n  },\\n  endian: function endian(data) {\\n    return this.endian = data;\\n  },\\n  encoding: function encoding(data) {\\n    return this.encoding = data;\\n  },\\n  dimension: function dimension(data) {\\n    return this.dim = parseInt(data, 10);\\n  },\\n  sizes: function sizes(data) {\\n    var i;\\n    return this.sizes = function () {\\n      var _ref = data.split(/\\\\s+/);\\n\\n      var _results = [];\\n\\n      for (var _i = 0, _len = _ref.length; _i < _len; _i++) {\\n        i = _ref[_i];\\n\\n        _results.push(parseInt(i, 10));\\n      }\\n\\n      return _results;\\n    }();\\n  },\\n  space: function space(data) {\\n    return this.space = data;\\n  },\\n  'space origin': function spaceOrigin(data) {\\n    return this.space_origin = data.split('(')[1].split(')')[0].split(',');\\n  },\\n  'space directions': function spaceDirections(data) {\\n    var f, v;\\n    var parts = data.match(/\\\\(.*?\\\\)/g);\\n    return this.vectors = function () {\\n      var _results = [];\\n\\n      for (var _i = 0, _len = parts.length; _i < _len; _i++) {\\n        v = parts[_i];\\n\\n        _results.push(function () {\\n          var _ref = v.slice(1, -1).split(/,/);\\n\\n          var _results2 = [];\\n\\n          for (var _j = 0, _len2 = _ref.length; _j < _len2; _j++) {\\n            f = _ref[_j];\\n\\n            _results2.push(parseFloat(f));\\n          }\\n\\n          return _results2;\\n        }());\\n      }\\n\\n      return _results;\\n    }();\\n  },\\n  spacings: function spacings(data) {\\n    var f;\\n    var parts = data.split(/\\\\s+/);\\n    return this.spacings = function () {\\n      var _results = [];\\n\\n      for (var _i = 0, _len = parts.length; _i < _len; _i++) {\\n        f = parts[_i];\\n\\n        _results.push(parseFloat(f));\\n      }\\n\\n      return _results;\\n    }();\\n  }\\n};\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"_typeof\",\"obj\",\"Symbol\",\"iterator\",\"constructor\",\"prototype\",\"_defineProperties\",\"target\",\"props\",\"i\",\"length\",\"descriptor\",\"enumerable\",\"configurable\",\"writable\",\"Object\",\"defineProperty\",\"key\",\"_createClass\",\"Constructor\",\"protoProps\",\"staticProps\",\"_getPrototypeOf\",\"o\",\"setPrototypeOf\",\"getPrototypeOf\",\"__proto__\",\"_inherits\",\"subClass\",\"superClass\",\"TypeError\",\"create\",\"value\",\"_setPrototypeOf\",\"p\",\"NRRDLoader\",\"_three\",\"_fflate\",\"_Volume\",\"_Loader\",\"manager\",\"instance\",\"call\",\"self\",\"ReferenceError\",\"load\",\"url\",\"onLoad\",\"onProgress\",\"onError\",\"scope\",\"loader\",\"FileLoader\",\"setPath\",\"path\",\"setResponseType\",\"setRequestHeader\",\"requestHeader\",\"setWithCredentials\",\"withCredentials\",\"data\",\"parse\",\"e\",\"console\",\"error\",\"itemError\",\"parseDataAsText\",\"start\",\"end\",\"number\",\"lengthOfTheResult\",\"headerObject\",\"sizes\",\"reduce\",\"previous\",\"current\",\"base\",\"encoding\",\"result\",\"__array\",\"resultIndex\",\"parsingFunction\",\"parseInt\",\"Float32Array\",\"Float64Array\",\"parseFloat\",\"_i3\",\"String\",\"fromCharCode\",\"_data\",\"_dataPointer\",\"_nativeLittleEndian\",\"Int8Array\",\"buffer\",\"Int16Array\",\"_bytes\",\"scan\",\"type\",\"chunks\",\"undefined\",\"_chunkSize\",\"_array_type\",\"Uint8Array\",\"Uint16Array\",\"Uint32Array\",\"Int32Array\",\"slice\",\"_littleEndian\",\"u8\",\"array\",\"byteOffset\",\"byteLength\",\"_i2\",\"chunkSize\",\"j\",\"k\",\"tmp\",\"_length\",\"_header\",\"_data_start\",\"parseChars\",\"parseHeader\",\"header\",\"fn\",\"_len\",\"lines\",\"split\",\"_i\",\"l\",\"match\",\"isNrrd\",\"m\",\"field\",\"trim\",\"_fieldFunctions\",\"Error\",\"vectors\",\"spacings\",\"Vector3\",\"isNaN\",\"multiplyScalar\",\"subarray\",\"substring\",\"gunzipSync\",\"_copy\",\"_i4\",\"volume\",\"Volume\",\"min_max\",\"computeMinMax\",\"min\",\"max\",\"windowLow\",\"windowHigh\",\"dimensions\",\"xLength\",\"yLength\",\"zLength\",\"spacingX\",\"spacingY\",\"spacingZ\",\"spacing\",\"matrix\",\"Matrix4\",\"_spaceY\",\"_spaceX\",\"space\",\"v\",\"set\",\"_spaceZ\",\"inverseMatrix\",\"copy\",\"invert\",\"RASDimensions\",\"applyMatrix4\",\"round\",\"toArray\",\"map\",\"Math\",\"abs\",\"Infinity\",\"lowerThreshold\",\"upperThreshold\",\"output\",\"Loader\",\"endian\",\"dimension\",\"dim\",\"_ref\",\"_results\",\"push\",\"spaceOrigin\",\"space_origin\",\"spaceDirections\",\"parts\",\"_results2\",\"_j\",\"_len2\",\"f\"]\n}\n"]