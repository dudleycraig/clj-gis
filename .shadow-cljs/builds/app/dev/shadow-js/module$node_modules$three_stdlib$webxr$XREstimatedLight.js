["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/three-stdlib/webxr/XREstimatedLight.js"],"~:js","shadow$provide.module$node_modules$three_stdlib$webxr$XREstimatedLight=function(global,require,module,exports){function _typeof(obj$jscomp$0){_typeof=\"function\"===typeof Symbol&&\"symbol\"===typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&\"function\"===typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?\"symbol\":typeof obj};return _typeof(obj$jscomp$0)}function _possibleConstructorReturn(self,call){return!call||\"object\"!==_typeof(call)&&\"function\"!==typeof call?\n_assertThisInitialized(self):call}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o$jscomp$0)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return self}function _inherits(subClass,superClass){if(\"function\"!==typeof superClass&&null!==superClass)throw new TypeError(\"Super expression must either be null or a function\");\nsubClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}});superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o$jscomp$0,p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};return _setPrototypeOf(o$jscomp$0,p$jscomp$0)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError(\"Cannot call a class as a function\");}function _defineProperties(target,\nprops){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;\"value\"in descriptor&&(descriptor.writable=!0);Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}Object.defineProperty(exports,\"__esModule\",{value:!0});exports.XREstimatedLight=\nvoid 0;var _three=require(\"module$node_modules$three$build$three_module\"),SessionLightProbe=function(){function SessionLightProbe(xrLight,renderer,lightProbe,environmentEstimation,estimationStartCallback){var _this=this;_classCallCheck(this,SessionLightProbe);this.xrLight=xrLight;this.renderer=renderer;this.lightProbe=lightProbe;this.xrWebGLBinding=null;this.estimationStartCallback=estimationStartCallback;this.frameCallback=this.onXRFrame.bind(this);lightProbe=renderer.xr.getSession();if(environmentEstimation&&\n\"XRWebGLBinding\"in window){environmentEstimation=new _three.WebGLCubeRenderTarget(16);xrLight.environment=environmentEstimation.texture;xrLight=renderer.getContext();switch(lightProbe.preferredReflectionFormat){case \"srgba8\":xrLight.getExtension(\"EXT_sRGB\");break;case \"rgba16f\":xrLight.getExtension(\"OES_texture_half_float\")}this.xrWebGLBinding=new XRWebGLBinding(lightProbe,xrLight);this.lightProbe.addEventListener(\"reflectionchange\",function(){_this.updateReflection()})}lightProbe.requestAnimationFrame(this.frameCallback)}\n_createClass(SessionLightProbe,[{key:\"updateReflection\",value:function(){var textureProperties=this.renderer.properties.get(this.xrLight.environment);if(textureProperties){var cubeMap=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);cubeMap&&(textureProperties.__webglTexture=cubeMap)}}},{key:\"onXRFrame\",value:function(time,xrFrame){this.xrLight&&(xrFrame.session.requestAnimationFrame(this.frameCallback),time=xrFrame.getLightEstimate(this.lightProbe))&&(this.xrLight.lightProbe.sh.fromArray(time.sphericalHarmonicsCoefficients),\nthis.xrLight.lightProbe.intensity=1,xrFrame=Math.max(1,Math.max(time.primaryLightIntensity.x,Math.max(time.primaryLightIntensity.y,time.primaryLightIntensity.z))),this.xrLight.directionalLight.color.setRGB(time.primaryLightIntensity.x/xrFrame,time.primaryLightIntensity.y/xrFrame,time.primaryLightIntensity.z/xrFrame),this.xrLight.directionalLight.intensity=xrFrame,this.xrLight.directionalLight.position.copy(time.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=\nnull))}},{key:\"dispose\",value:function(){this.xrWebGLBinding=this.lightProbe=this.renderer=this.xrLight=null}}]);return SessionLightProbe}();global=function(_Group){function XREstimatedLight(renderer){var environmentEstimation=1<arguments.length&&void 0!==arguments[1]?arguments[1]:!0;_classCallCheck(this,XREstimatedLight);var _this2=_possibleConstructorReturn(this,_getPrototypeOf(XREstimatedLight).call(this));_this2.lightProbe=new _three.LightProbe;_this2.lightProbe.intensity=0;_this2.add(_this2.lightProbe);\n_this2.directionalLight=new _three.DirectionalLight;_this2.directionalLight.intensity=0;_this2.add(_this2.directionalLight);var sessionLightProbe=_this2.environment=null,estimationStarted=!1;renderer.xr.addEventListener(\"sessionstart\",function(){var session=renderer.xr.getSession();\"requestLightProbe\"in session&&session.requestLightProbe({reflectionFormat:session.preferredReflectionFormat}).then(function(probe){sessionLightProbe=new SessionLightProbe(_assertThisInitialized(_this2),renderer,probe,\nenvironmentEstimation,function(){estimationStarted=!0;_this2.dispatchEvent({type:\"estimationstart\"})})})});renderer.xr.addEventListener(\"sessionend\",function(){sessionLightProbe&&(sessionLightProbe.dispose(),sessionLightProbe=null);estimationStarted&&_this2.dispatchEvent({type:\"estimationend\"})});_this2.dispose=function(){sessionLightProbe&&(sessionLightProbe.dispose(),sessionLightProbe=null);_this2.remove(_this2.lightProbe);_this2.lightProbe=null;_this2.remove(_this2.directionalLight);_this2.directionalLight=\nnull;_this2.environment=null};return _this2}_inherits(XREstimatedLight,_Group);return XREstimatedLight}(_three.Group);exports.XREstimatedLight=global}","~:source","shadow$provide[\"module$node_modules$three_stdlib$webxr$XREstimatedLight\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.XREstimatedLight = void 0;\n\nvar _three = require(\"three\");\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nvar SessionLightProbe =\n/*#__PURE__*/\nfunction () {\n  function SessionLightProbe(xrLight, renderer, lightProbe, environmentEstimation, estimationStartCallback) {\n    var _this = this;\n\n    _classCallCheck(this, SessionLightProbe);\n\n    this.xrLight = xrLight;\n    this.renderer = renderer;\n    this.lightProbe = lightProbe;\n    this.xrWebGLBinding = null;\n    this.estimationStartCallback = estimationStartCallback;\n    this.frameCallback = this.onXRFrame.bind(this);\n    var session = renderer.xr.getSession(); // If the XRWebGLBinding class is available then we can also query an\n    // estimated reflection cube map.\n\n    if (environmentEstimation && 'XRWebGLBinding' in window) {\n      // This is the simplest way I know of to initialize a WebGL cubemap in Three.\n      var cubeRenderTarget = new _three.WebGLCubeRenderTarget(16);\n      xrLight.environment = cubeRenderTarget.texture;\n      var gl = renderer.getContext(); // Ensure that we have any extensions needed to use the preferred cube map format.\n\n      switch (session.preferredReflectionFormat) {\n        case 'srgba8':\n          gl.getExtension('EXT_sRGB');\n          break;\n\n        case 'rgba16f':\n          gl.getExtension('OES_texture_half_float');\n          break;\n      }\n\n      this.xrWebGLBinding = new XRWebGLBinding(session, gl);\n      this.lightProbe.addEventListener('reflectionchange', function () {\n        _this.updateReflection();\n      });\n    } // Start monitoring the XR animation frame loop to look for lighting\n    // estimation changes.\n\n\n    session.requestAnimationFrame(this.frameCallback);\n  }\n\n  _createClass(SessionLightProbe, [{\n    key: \"updateReflection\",\n    value: function updateReflection() {\n      var textureProperties = this.renderer.properties.get(this.xrLight.environment);\n\n      if (textureProperties) {\n        var cubeMap = this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);\n\n        if (cubeMap) {\n          textureProperties.__webglTexture = cubeMap;\n        }\n      }\n    }\n  }, {\n    key: \"onXRFrame\",\n    value: function onXRFrame(time, xrFrame) {\n      // If either this obejct or the XREstimatedLight has been destroyed, stop\n      // running the frame loop.\n      if (!this.xrLight) {\n        return;\n      }\n\n      var session = xrFrame.session;\n      session.requestAnimationFrame(this.frameCallback);\n      var lightEstimate = xrFrame.getLightEstimate(this.lightProbe);\n\n      if (lightEstimate) {\n        // We can copy the estimate's spherical harmonics array directly into the light probe.\n        this.xrLight.lightProbe.sh.fromArray(lightEstimate.sphericalHarmonicsCoefficients);\n        this.xrLight.lightProbe.intensity = 1.0; // For the directional light we have to normalize the color and set the scalar as the\n        // intensity, since WebXR can return color values that exceed 1.0.\n\n        var intensityScalar = Math.max(1.0, Math.max(lightEstimate.primaryLightIntensity.x, Math.max(lightEstimate.primaryLightIntensity.y, lightEstimate.primaryLightIntensity.z)));\n        this.xrLight.directionalLight.color.setRGB(lightEstimate.primaryLightIntensity.x / intensityScalar, lightEstimate.primaryLightIntensity.y / intensityScalar, lightEstimate.primaryLightIntensity.z / intensityScalar);\n        this.xrLight.directionalLight.intensity = intensityScalar;\n        this.xrLight.directionalLight.position.copy(lightEstimate.primaryLightDirection);\n\n        if (this.estimationStartCallback) {\n          this.estimationStartCallback();\n          this.estimationStartCallback = null;\n        }\n      }\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.xrLight = null;\n      this.renderer = null;\n      this.lightProbe = null;\n      this.xrWebGLBinding = null;\n    }\n  }]);\n\n  return SessionLightProbe;\n}();\n\nvar XREstimatedLight =\n/*#__PURE__*/\nfunction (_Group) {\n  _inherits(XREstimatedLight, _Group);\n\n  function XREstimatedLight(renderer) {\n    var _this2;\n\n    var environmentEstimation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    _classCallCheck(this, XREstimatedLight);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(XREstimatedLight).call(this));\n    _this2.lightProbe = new _three.LightProbe();\n    _this2.lightProbe.intensity = 0;\n\n    _this2.add(_this2.lightProbe);\n\n    _this2.directionalLight = new _three.DirectionalLight();\n    _this2.directionalLight.intensity = 0;\n\n    _this2.add(_this2.directionalLight); // Will be set to a cube map in the SessionLightProbe is environment estimation is\n    // available and requested.\n\n\n    _this2.environment = null;\n    var sessionLightProbe = null;\n    var estimationStarted = false;\n    renderer.xr.addEventListener('sessionstart', function () {\n      var session = renderer.xr.getSession();\n\n      if ('requestLightProbe' in session) {\n        session.requestLightProbe({\n          reflectionFormat: session.preferredReflectionFormat\n        }).then(function (probe) {\n          sessionLightProbe = new SessionLightProbe(_assertThisInitialized(_this2), renderer, probe, environmentEstimation, function () {\n            estimationStarted = true; // Fired to indicate that the estimated lighting values are now being updated.\n\n            _this2.dispatchEvent({\n              type: 'estimationstart'\n            });\n          });\n        });\n      }\n    });\n    renderer.xr.addEventListener('sessionend', function () {\n      if (sessionLightProbe) {\n        sessionLightProbe.dispose();\n        sessionLightProbe = null;\n      }\n\n      if (estimationStarted) {\n        // Fired to indicate that the estimated lighting values are no longer being updated.\n        _this2.dispatchEvent({\n          type: 'estimationend'\n        });\n      }\n    }); // Done inline to provide access to sessionLightProbe.\n\n    _this2.dispose = function () {\n      if (sessionLightProbe) {\n        sessionLightProbe.dispose();\n        sessionLightProbe = null;\n      }\n\n      _this2.remove(_this2.lightProbe);\n\n      _this2.lightProbe = null;\n\n      _this2.remove(_this2.directionalLight);\n\n      _this2.directionalLight = null;\n      _this2.environment = null;\n    };\n\n    return _this2;\n  }\n\n  return XREstimatedLight;\n}(_three.Group);\n\nexports.XREstimatedLight = XREstimatedLight;\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$three$build$three_module","~$shadow.js"]],"~:properties",["^5",["intensity","renderer","lightProbe","prototype","xrWebGLBinding","key","__esModule","dispose","reflectionFormat","xrLight","configurable","value","enumerable","writable","__webglTexture","estimationStartCallback","XREstimatedLight","type","environment","__proto__","frameCallback","directionalLight","constructor"]],"~:compiled-at",1630917515560,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$three_stdlib$webxr$XREstimatedLight.js\",\n\"lineCount\":12,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/three-stdlib/webxr/XREstimatedLight.js\"],\n\"sourcesContent\":[\"shadow$provide[\\\"module$node_modules$three_stdlib$webxr$XREstimatedLight\\\"] = function(global,require,module,exports) {\\n\\\"use strict\\\";\\n\\nObject.defineProperty(exports, \\\"__esModule\\\", {\\n  value: true\\n});\\nexports.XREstimatedLight = void 0;\\n\\nvar _three = require(\\\"three\\\");\\n\\nfunction _typeof(obj) { if (typeof Symbol === \\\"function\\\" && typeof Symbol.iterator === \\\"symbol\\\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \\\"function\\\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \\\"symbol\\\" : typeof obj; }; } return _typeof(obj); }\\n\\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \\\"object\\\" || typeof call === \\\"function\\\")) { return call; } return _assertThisInitialized(self); }\\n\\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\\n\\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\\\"this hasn't been initialised - super() hasn't been called\\\"); } return self; }\\n\\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \\\"function\\\" && superClass !== null) { throw new TypeError(\\\"Super expression must either be null or a function\\\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\\n\\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\\n\\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\\\"Cannot call a class as a function\\\"); } }\\n\\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\\\"value\\\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\\n\\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\\n\\nvar SessionLightProbe =\\n/*#__PURE__*/\\nfunction () {\\n  function SessionLightProbe(xrLight, renderer, lightProbe, environmentEstimation, estimationStartCallback) {\\n    var _this = this;\\n\\n    _classCallCheck(this, SessionLightProbe);\\n\\n    this.xrLight = xrLight;\\n    this.renderer = renderer;\\n    this.lightProbe = lightProbe;\\n    this.xrWebGLBinding = null;\\n    this.estimationStartCallback = estimationStartCallback;\\n    this.frameCallback = this.onXRFrame.bind(this);\\n    var session = renderer.xr.getSession(); // If the XRWebGLBinding class is available then we can also query an\\n    // estimated reflection cube map.\\n\\n    if (environmentEstimation && 'XRWebGLBinding' in window) {\\n      // This is the simplest way I know of to initialize a WebGL cubemap in Three.\\n      var cubeRenderTarget = new _three.WebGLCubeRenderTarget(16);\\n      xrLight.environment = cubeRenderTarget.texture;\\n      var gl = renderer.getContext(); // Ensure that we have any extensions needed to use the preferred cube map format.\\n\\n      switch (session.preferredReflectionFormat) {\\n        case 'srgba8':\\n          gl.getExtension('EXT_sRGB');\\n          break;\\n\\n        case 'rgba16f':\\n          gl.getExtension('OES_texture_half_float');\\n          break;\\n      }\\n\\n      this.xrWebGLBinding = new XRWebGLBinding(session, gl);\\n      this.lightProbe.addEventListener('reflectionchange', function () {\\n        _this.updateReflection();\\n      });\\n    } // Start monitoring the XR animation frame loop to look for lighting\\n    // estimation changes.\\n\\n\\n    session.requestAnimationFrame(this.frameCallback);\\n  }\\n\\n  _createClass(SessionLightProbe, [{\\n    key: \\\"updateReflection\\\",\\n    value: function updateReflection() {\\n      var textureProperties = this.renderer.properties.get(this.xrLight.environment);\\n\\n      if (textureProperties) {\\n        var cubeMap = this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);\\n\\n        if (cubeMap) {\\n          textureProperties.__webglTexture = cubeMap;\\n        }\\n      }\\n    }\\n  }, {\\n    key: \\\"onXRFrame\\\",\\n    value: function onXRFrame(time, xrFrame) {\\n      // If either this obejct or the XREstimatedLight has been destroyed, stop\\n      // running the frame loop.\\n      if (!this.xrLight) {\\n        return;\\n      }\\n\\n      var session = xrFrame.session;\\n      session.requestAnimationFrame(this.frameCallback);\\n      var lightEstimate = xrFrame.getLightEstimate(this.lightProbe);\\n\\n      if (lightEstimate) {\\n        // We can copy the estimate's spherical harmonics array directly into the light probe.\\n        this.xrLight.lightProbe.sh.fromArray(lightEstimate.sphericalHarmonicsCoefficients);\\n        this.xrLight.lightProbe.intensity = 1.0; // For the directional light we have to normalize the color and set the scalar as the\\n        // intensity, since WebXR can return color values that exceed 1.0.\\n\\n        var intensityScalar = Math.max(1.0, Math.max(lightEstimate.primaryLightIntensity.x, Math.max(lightEstimate.primaryLightIntensity.y, lightEstimate.primaryLightIntensity.z)));\\n        this.xrLight.directionalLight.color.setRGB(lightEstimate.primaryLightIntensity.x / intensityScalar, lightEstimate.primaryLightIntensity.y / intensityScalar, lightEstimate.primaryLightIntensity.z / intensityScalar);\\n        this.xrLight.directionalLight.intensity = intensityScalar;\\n        this.xrLight.directionalLight.position.copy(lightEstimate.primaryLightDirection);\\n\\n        if (this.estimationStartCallback) {\\n          this.estimationStartCallback();\\n          this.estimationStartCallback = null;\\n        }\\n      }\\n    }\\n  }, {\\n    key: \\\"dispose\\\",\\n    value: function dispose() {\\n      this.xrLight = null;\\n      this.renderer = null;\\n      this.lightProbe = null;\\n      this.xrWebGLBinding = null;\\n    }\\n  }]);\\n\\n  return SessionLightProbe;\\n}();\\n\\nvar XREstimatedLight =\\n/*#__PURE__*/\\nfunction (_Group) {\\n  _inherits(XREstimatedLight, _Group);\\n\\n  function XREstimatedLight(renderer) {\\n    var _this2;\\n\\n    var environmentEstimation = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\\n\\n    _classCallCheck(this, XREstimatedLight);\\n\\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(XREstimatedLight).call(this));\\n    _this2.lightProbe = new _three.LightProbe();\\n    _this2.lightProbe.intensity = 0;\\n\\n    _this2.add(_this2.lightProbe);\\n\\n    _this2.directionalLight = new _three.DirectionalLight();\\n    _this2.directionalLight.intensity = 0;\\n\\n    _this2.add(_this2.directionalLight); // Will be set to a cube map in the SessionLightProbe is environment estimation is\\n    // available and requested.\\n\\n\\n    _this2.environment = null;\\n    var sessionLightProbe = null;\\n    var estimationStarted = false;\\n    renderer.xr.addEventListener('sessionstart', function () {\\n      var session = renderer.xr.getSession();\\n\\n      if ('requestLightProbe' in session) {\\n        session.requestLightProbe({\\n          reflectionFormat: session.preferredReflectionFormat\\n        }).then(function (probe) {\\n          sessionLightProbe = new SessionLightProbe(_assertThisInitialized(_this2), renderer, probe, environmentEstimation, function () {\\n            estimationStarted = true; // Fired to indicate that the estimated lighting values are now being updated.\\n\\n            _this2.dispatchEvent({\\n              type: 'estimationstart'\\n            });\\n          });\\n        });\\n      }\\n    });\\n    renderer.xr.addEventListener('sessionend', function () {\\n      if (sessionLightProbe) {\\n        sessionLightProbe.dispose();\\n        sessionLightProbe = null;\\n      }\\n\\n      if (estimationStarted) {\\n        // Fired to indicate that the estimated lighting values are no longer being updated.\\n        _this2.dispatchEvent({\\n          type: 'estimationend'\\n        });\\n      }\\n    }); // Done inline to provide access to sessionLightProbe.\\n\\n    _this2.dispose = function () {\\n      if (sessionLightProbe) {\\n        sessionLightProbe.dispose();\\n        sessionLightProbe = null;\\n      }\\n\\n      _this2.remove(_this2.lightProbe);\\n\\n      _this2.lightProbe = null;\\n\\n      _this2.remove(_this2.directionalLight);\\n\\n      _this2.directionalLight = null;\\n      _this2.environment = null;\\n    };\\n\\n    return _this2;\\n  }\\n\\n  return XREstimatedLight;\\n}(_three.Group);\\n\\nexports.XREstimatedLight = XREstimatedLight;\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"_typeof\",\"obj\",\"Symbol\",\"iterator\",\"constructor\",\"prototype\",\"_possibleConstructorReturn\",\"self\",\"call\",\"_assertThisInitialized\",\"_getPrototypeOf\",\"o\",\"Object\",\"setPrototypeOf\",\"getPrototypeOf\",\"__proto__\",\"ReferenceError\",\"_inherits\",\"subClass\",\"superClass\",\"TypeError\",\"create\",\"value\",\"writable\",\"configurable\",\"_setPrototypeOf\",\"p\",\"_classCallCheck\",\"instance\",\"Constructor\",\"_defineProperties\",\"target\",\"props\",\"i\",\"length\",\"descriptor\",\"enumerable\",\"defineProperty\",\"key\",\"_createClass\",\"protoProps\",\"staticProps\",\"XREstimatedLight\",\"_three\",\"SessionLightProbe\",\"xrLight\",\"renderer\",\"lightProbe\",\"environmentEstimation\",\"estimationStartCallback\",\"_this\",\"xrWebGLBinding\",\"frameCallback\",\"onXRFrame\",\"bind\",\"session\",\"xr\",\"getSession\",\"window\",\"cubeRenderTarget\",\"WebGLCubeRenderTarget\",\"environment\",\"texture\",\"gl\",\"getContext\",\"preferredReflectionFormat\",\"getExtension\",\"XRWebGLBinding\",\"addEventListener\",\"updateReflection\",\"requestAnimationFrame\",\"textureProperties\",\"properties\",\"get\",\"cubeMap\",\"getReflectionCubeMap\",\"__webglTexture\",\"time\",\"xrFrame\",\"lightEstimate\",\"getLightEstimate\",\"sh\",\"fromArray\",\"sphericalHarmonicsCoefficients\",\"intensity\",\"intensityScalar\",\"Math\",\"max\",\"primaryLightIntensity\",\"x\",\"y\",\"z\",\"directionalLight\",\"color\",\"setRGB\",\"position\",\"copy\",\"primaryLightDirection\",\"dispose\",\"_Group\",\"arguments\",\"undefined\",\"_this2\",\"LightProbe\",\"add\",\"DirectionalLight\",\"sessionLightProbe\",\"estimationStarted\",\"requestLightProbe\",\"reflectionFormat\",\"then\",\"probe\",\"dispatchEvent\",\"type\",\"_this2.dispose\",\"remove\",\"Group\"]\n}\n"]